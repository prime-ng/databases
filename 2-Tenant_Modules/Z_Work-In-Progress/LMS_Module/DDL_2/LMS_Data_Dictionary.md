# LMS - Quiz & Quest Module Data Dictionary

## 1. Introduction
This document details the database schema for the LMS Quiz and Quest modules, designed for MySQL 8.x and Laravel 10.x.

## 2. Shared Configuration Tables

### 2.1. lms_difficulty_distribution_configs
Configuration header for balancing question difficulty in quizzes and quests.

| Column Name | Data Type | Constraint | Description |
| :--- | :--- | :--- | :--- |
| id | BIGINT UNSIGNED | PK, Auto Inc | Unique identifier |
| code | VARCHAR(50) | Unique | Config code (e.g., 'STD_QUIZ_EASY') |
| name | VARCHAR(100) | Not Null | Human-readable name |
| description | VARCHAR(255) | Nullable | Description of the configuration |
| used_for | VARCHAR(50) | Not Null | Usage context (QUIZ, QUEST, EXAM). FK to sys_dropdowns(key='qns_usage_type') |
| is_active | TINYINT(1) | Default 1 | Active status |
| created_at, updated_at | TIMESTAMP | | Audit timestamps |
| deleted_at | TIMESTAMP | Nullable | Soft delete timestamp |

### 2.2. lms_difficulty_distribution_details
Detailed rules for difficulty distribution (e.g., 30% Easy MCQs).

| Column Name | Data Type | Constraint | Description |
| :--- | :--- | :--- | :--- |
| id | BIGINT UNSIGNED | PK, Auto Inc | Unique identifier |
| config_id | BIGINT UNSIGNED | FK | Reference to lms_difficulty_distribution_configs.id |
| question_type_id | INT UNSIGNED | FK | Reference to slb_question_types.id (MCQ, Descriptive, etc.) |
| complexity_level_id | INT UNSIGNED | FK | Reference to slb_complexity_level.id (Level 1, 2, 3) |
| min_percentage | DECIMAL(5,2) | Default 0 | Minimum percentage of questions |
| max_percentage | DECIMAL(5,2) | Default 0 | Maximum percentage of questions |
| marks_per_question | DECIMAL(5,2) | Default 1 | Marks assigned for this specific type/complexity |

## 3. Quiz Module Tables

### 3.1. lms_quizzes
Defines a Quiz entity (set of questions with rules).

| Column Name | Data Type | Constraint | Description |
| :--- | :--- | :--- | :--- |
| id | BIGINT UNSIGNED | PK, Auto Inc | Unique identifier |
| uuid | BINARY(16) | Unique | UUID for external ref |
| quiz_code | VARCHAR(50) | Unique | Human readable code |
| title | VARCHAR(255) | Not Null | Quiz title |
| description | TEXT | Nullable | Detailed description |
| instructions | TEXT | Nullable | Instructions for students (JSON/HTML) |
| quiz_type_id | BIGINT UNSIGNED | FK | Type (Formative, Summative). FK to sys_dropdowns |
| scope_topic_id | BIGINT UNSIGNED | FK | Primary topic scope. FK to slb_topics.id |
| status | VARCHAR(20) | Default 'DRAFT' | Workflow status (DRAFT, PUBLISHED, etc.) |
| duration_minutes | INT UNSIGNED | Nullable | Time limit in minutes |
| total_marks | DECIMAL(8,2) | Default 0 | Total marks |
| total_questions | INT UNSIGNED | Default 0 | Total question count |
| passing_percentage | DECIMAL(5,2) | Default 33.00 | Passing criteria |
| allow_multiple_attempts | TINYINT(1) | Default 0 | If true, user can retry |
| max_attempts | TINYINT UNSIGNED | Default 1 | Max allowed attempts |
| negative_marking_factor | DECIMAL(3,2) | Default 0.00 | e.g. 0.25 for 1/4 marks deduction |
| is_randomized | TINYINT(1) | Default 0 | Randomize question order |
| show_result_immediately | TINYINT(1) | Default 0 | Show marks right after submission |
| difficulty_config_id | BIGINT UNSIGNED | FK, Nullable | Auto-balancing rule. FK to lms_difficulty_distribution_configs |
| is_system_generated | TINYINT(1) | Default 0 | If generated by AI/System |
| created_by | BIGINT UNSIGNED | FK | User who created/owns the quiz |

### 3.2. lms_quiz_questions
Junction table linking Quizzes to Questions.

| Column Name | Data Type | Constraint | Description |
| :--- | :--- | :--- | :--- |
| id | BIGINT UNSIGNED | PK, Auto Inc | Unique identifier |
| quiz_id | BIGINT UNSIGNED | FK | Reference to lms_quizzes.id |
| question_id | BIGINT UNSIGNED | FK | Reference to qns_questions_bank.id |
| ordinal | INT UNSIGNED | Default 0 | Sequence order |
| marks | DECIMAL(5,2) | Nullable | Override marks (if different from question default) |

### 3.3. lms_quiz_allocations
Assigns a Quiz to target audience (Class/Section/Student).

| Column Name | Data Type | Constraint | Description |
| :--- | :--- | :--- | :--- |
| id | BIGINT UNSIGNED | PK, Auto Inc | Unique identifier |
| quiz_id | BIGINT UNSIGNED | FK | Reference to lms_quizzes.id |
| allocation_type | ENUM | Not Null | 'CLASS', 'SECTION', 'GROUP', 'STUDENT' |
| target_id | BIGINT UNSIGNED | Not Null | ID of Class/Section/Group/Student |
| due_date | DATETIME | Nullable | Due date for this specific allocation |
| cut_off_date | DATETIME | Nullable | Hard deadline (late submission not allowed) |
| published_at | DATETIME | Nullable | When it becomes visible |
| result_publish_date | DATETIME | Nullable | When results are revealed |

## 4. Quest Module Tables

### 4.1. lms_quests
Defines a Quest entity (Collection of questions spanning multiple topics/lessons).

| Column Name | Data Type | Constraint | Description |
| :--- | :--- | :--- | :--- |
| id | BIGINT UNSIGNED | PK, Auto Inc | Unique identifier |
| uuid | BINARY(16) | Unique | UUID |
| quest_code | VARCHAR(50) | Unique | Code |
| title | VARCHAR(255) | Not Null | Title |
| description | TEXT | Nullable | Description |
| instructions | TEXT | Nullable | Instructions |
| quest_type_id | BIGINT UNSIGNED | FK | Type. FK to sys_dropdowns |
| status | VARCHAR(20) | Default 'DRAFT' | Status |
| duration_minutes | INT UNSIGNED | Nullable | Duration |
| total_marks | DECIMAL(8,2) | Default 0 | Total Marks |
| passing_percentage | DECIMAL(5,2) | Default 33 | Passing % |
| difficulty_config_id | BIGINT UNSIGNED | FK, Nullable | Balancing rule |
| is_system_generated | TINYINT(1) | Default 0 | AI generated |

### 4.2. lms_quest_scopes
Defines the syllabus scope for a Quest (e.g. Topics covered).

| Column Name | Data Type | Constraint | Description |
| :--- | :--- | :--- | :--- |
| id | BIGINT UNSIGNED | PK, Auto Inc | Unique identifier |
| quest_id | BIGINT UNSIGNED | FK | Reference to lms_quests.id |
| topic_id | BIGINT UNSIGNED | FK | Reference to slb_topics.id |
| question_type_id | INT UNSIGNED | FK, Nullable | Filter for specific question types |
| number_of_questions | INT UNSIGNED | Default 0 | Target count from this scope |

### 4.3. lms_quest_questions
Junction table linking Quests to Questions.

| Column Name | Data Type | Constraint | Description |
| :--- | :--- | :--- | :--- |
| id | BIGINT UNSIGNED | PK, Auto Inc | Unique identifier |
| quest_id | BIGINT UNSIGNED | FK | Reference to lms_quests.id |
| question_id | BIGINT UNSIGNED | FK | Reference to qns_questions_bank.id |
| ordinal | INT UNSIGNED | Default 0 | Order |
| marks | DECIMAL(5,2) | Nullable | Override marks |

### 4.4. lms_quest_allocations
Assigns a Quest to audience.

| Column Name | Data Type | Constraint | Description |
| :--- | :--- | :--- | :--- |
| id | BIGINT UNSIGNED | PK, Auto Inc | Unique identifier |
| quest_id | BIGINT UNSIGNED | FK | Reference to lms_quests.id |
| allocation_type | ENUM | Not Null | 'CLASS', 'SECTION', 'GROUP', 'STUDENT' |
| target_id | BIGINT UNSIGNED | Not Null | Target ID |
| start_date | DATETIME | Nullable | Start |
| due_date | DATETIME | Nullable | Due |

## 5. Attempt & Result Tables (Shared Structure)

### 5.1. lms_student_attempts
Tracks a student's attempt at a Quiz or Quest.

| Column Name | Data Type | Constraint | Description |
| :--- | :--- | :--- | :--- |
| id | BIGINT UNSIGNED | PK, Auto Inc | Unique identifier |
| student_id | BIGINT UNSIGNED | FK | Reference to sch_students.id |
| assessment_type | ENUM | Not Null | 'QUIZ', 'QUEST' |
| assessment_id | BIGINT UNSIGNED | Not Null | ID of Quiz or Quest |
| allocation_id | BIGINT UNSIGNED | FK | Reference to allocation table |
| attempt_number | TINYINT UNSIGNED | Default 1 | 1st, 2nd, 3rd attempt |
| started_at | DATETIME | Not Null | Start timestamp |
| completed_at | DATETIME | Nullable | Submission timestamp |
| status | VARCHAR(20) | Default 'IN_PROGRESS' | IN_PROGRESS, SUBMITTED, TIMEOUT, ABANDONED |
| total_score | DECIMAL(8,2) | Nullable | Score obtained |
| percentage | DECIMAL(5,2) | Nullable | Percentage |
| is_passed | TINYINT(1) | Default 0 | Pass/Fail status |
| feedback | TEXT | Nullable | Teacher remarks |

### 5.2. lms_student_attempt_answers
Records specific answers given by student.

| Column Name | Data Type | Constraint | Description |
| :--- | :--- | :--- | :--- |
| id | BIGINT UNSIGNED | PK, Auto Inc | Unique identifier |
| attempt_id | BIGINT UNSIGNED | FK | Reference to lms_student_attempts.id |
| question_id | BIGINT UNSIGNED | FK | Reference to qns_questions_bank.id |
| selected_option_id | BIGINT UNSIGNED | FK, Nullable | For MCQs. FK to qns_question_options.id |
| answer_text | TEXT | Nullable | For Descriptive/Fill-in-blanks |
| marks_obtained | DECIMAL(5,2) | Default 0 | Marks for this question |
| is_correct | TINYINT(1) | Nullable | Auto-graded correctness |
| time_taken_seconds | INT UNSIGNED | Default 0 | Time spent on this question |
